# –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å 023
## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ Kafka –Ω–∞ –±–∞–∑–µ Scala, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–æ–ø–∏–∫–æ–≤ Kafka, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ü–µ–ª–µ–≤—ã–µ —Ç–æ–ø–∏–∫–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Akka Streams –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Confluent Schema Registry –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Avro.
Altyn BI Kafka Streams Processing System –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ JSON-—Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ç–æ–ø–∏–∫–æ–≤ Kafka, –ø–∞—Ä—Å–∏–Ω–≥ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∫—É Avro-—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ü–µ–ª–µ–≤—ã–µ —Ç–æ–ø–∏–∫–∏. –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Kafka Flow –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Ç–∏–ø —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

–ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç flow:

–ü–æ—Ç—Ä–µ–±–ª—è–µ—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç–æ–ø–∏–∫–æ–≤ Kafka
–§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É
–ü–∞—Ä—Å–∏—Ç –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
–°–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Avro-—Å—Ö–µ–º
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ü–µ–ª–µ–≤—ã–µ —Ç–æ–ø–∏–∫–∏ Kafka
–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏: –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON-—Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ç–æ–ø–∏–∫–æ–≤ Kafka –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—ã—Ä—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å –æ–±–æ–≥–∞—â—ë–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
AVRO-—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è: –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AVRO-—Å—Ö–µ–º—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–¥—ë–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å—É–ø–µ—Ä–≤–∏–∑–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤
–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ Akka Streams –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
–ú–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –±–∞–∑–µ Akka Streams –∏ Apache Kafka —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Avro —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
Entry.scala (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
    ‚îÇ
    ‚îú‚îÄ‚îÄ Kafka_Flow_001 ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π Way4 (jms_from_way4)
    ‚îú‚îÄ‚îÄ Kafka_Flow_002 ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π DWH (jms_from_dwh)
    ‚îî‚îÄ‚îÄ Kafka_Flow_003 ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

- **Entry.scala** - –≥–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –ø–æ—Ç–æ–∫–æ–≤
- **Kafka_Flow_000.scala** - –±–∞–∑–æ–≤—ã–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Kafka_Flow_001.scala** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ Way4
- **Kafka_Flow_002.scala** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (DWH)
- **Kafka_Streams_Core.scala** - —è–¥—Ä–æ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Kafka (producer/consumer settings)
- **Flow_Supervision.scala** - –º–µ—Ö–∞–Ω–∏–∑–º –Ω–∞–¥–∑–æ—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Scala** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **Akka Streams** - —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **Apache Kafka** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- **Avro** - —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Schema Registry
- **Lift JSON** - –ø–∞—Ä—Å–∏–Ω–≥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON
- **SLF4J** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Kafka —Ç–æ–ø–∏–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (backoff strategy)
- Graceful restart –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫

### 2. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü–∞—Ä—Å–∏–Ω–≥ JSON —Å–æ–æ–±—â–µ–Ω–∏–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ (JSON ‚Üí Avro)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π

### 3. –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- Supervision strategy –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- RestartSource —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (1-15 –º–∏–Ω—É—Ç)
- –ú–∞–∫—Å–∏–º—É–º 20 –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤ –≤ —á–∞—Å
- Graceful shutdown –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

### 4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Akka Streams –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è backpressure

## üìä –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ Way4 (Kafka_Flow_001)
```scala
case class Transaction(
  ROWKEY: String,
  CPID: Option[String],      // ID –∫–∞—Ä—Ç—ã
  CPRN: Option[String],      // –†–µ—Ñ–µ—Ä–µ–Ω—Å –∫–∞—Ä—Ç—ã
  CPNA: Option[String],      // –ò–º—è –∫–∞—Ä—Ç—ã
  ACQUIRE: Option[String],   // –≠–∫–≤–∞–π–µ—Ä
  TERMINAL: Option[String],  // –¢–µ—Ä–º–∏–Ω–∞–ª
  STAMP: Option[String]      // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
)
```

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ DWH (Kafka_Flow_002)
```scala
case class CapTrnTransaction(
  ID: Option[Long],
  PID: Option[Long],
  PRID: Option[Long],
  OP: Option[String],        // –û–ø–µ—Ä–∞—Ü–∏—è
  CNLID: Option[String],     // ID –∫–∞–Ω–∞–ª–∞
  AM: Option[Double],        // –°—É–º–º–∞
  CUR: Option[String],       // –í–∞–ª—é—Ç–∞
  BAL: Option[Double],       // –ë–∞–ª–∞–Ω—Å
  STAMP: Option[Long],       // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ (Unix time)
  // ... + 20 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
)
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Typesafe Config –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```hocon
application {
  name = "Kafka Streams Processor"
  version = "1.0.0"
  cluster-name = "production"
}

kafka {
  groupid = "kafka-streams-group"
}

schema-registry {
  url = "http://schema-registry:8081"
}

akka.kafka.producer {
  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Kafka producer
}
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SLF4J –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```scala
log.info("Started Kafka_Flow_001 successfully")
log.error("Failed to parse JSON message", exception)
log.warn("Failed to convert timestamp")
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **INFO** - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø –ø–æ—Ç–æ–∫–æ–≤
- **WARN** - –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã)
- **ERROR** - –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–æ—Ç–æ–∫–∞

## üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è Supervision
```scala
case ex: Exception =>
  log.error(s"Error in stream: ${ex.getMessage}")
  scheduleRestart  // –ü–ª–∞–Ω–æ–≤–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
  Supervision.Stop
```

### Backoff Strategy
```scala
RestartSettings(
  minBackoff = 1.minute,
  maxBackoff = 15.minutes,
  randomFactor = 0.2
).withMaxRestarts(20, 1.hour)
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ Way4

```scala
// –í—Ö–æ–¥—è—â–µ–µ JSON —Å–æ–æ–±—â–µ–Ω–∏–µ
{
  "t": "doc.trn",
  "v": {
    "id": "12345",
    "stamp": "2024-01-15T10:30:00.000",
    "s_member_id": "BANK001",
    "s_number": "TERM001",
    "info": "CPID=1234567890;CPRN=REF001;CPNA=Card Name"
  }
}

// –†–µ–∑—É–ª—å—Ç–∞—Ç - Avro –∑–∞–ø–∏—Å—å –≤ —Ç–æ–ø–∏–∫–µ bank_statement
Record(
  CPID = Some("1234567890"),
  CPRN = Some("REF001"),
  CPNA = Some("Card Name"),
  ACQUIRE = Some("BANK001"),
  TERMINAL = Some("TERM001"),
  STAMP = Some(1705318200000L)
)
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Throughput**: –¥–æ 10,000 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫—É–Ω–¥—É –Ω–∞ –ø–æ—Ç–æ–∫
- **Latency**: < 100ms –¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **Backpressure**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Akka Streams
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 60+ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
